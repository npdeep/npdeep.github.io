<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Riddler: Shell Game and Trapping Electrons | Bits & Qubits</title>
<meta name=keywords content><meta name=description content="Markov Chains and Geometry Optimization"><meta name=author content><link rel=canonical href=https://pradeepniroula.com/expositions/riddler-22-07-29/><link crossorigin=anonymous href=/assets/css/stylesheet.fdbfe7a6b6fea3cb562a1eba2c947a5624be15591eb23b055448b30f77f9b96b.css integrity="sha256-/b/nprb+o8tWKh66LJR6ViS+FVkesjsFVEizD3f5uWs=" rel="preload stylesheet" as=style><link rel=icon href=https://pradeepniroula.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://pradeepniroula.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://pradeepniroula.com/favicon-32x32.png><link rel=apple-touch-icon href=https://pradeepniroula.com/apple-touch-icon.png><link rel=mask-icon href=https://pradeepniroula.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://pradeepniroula.com/expositions/riddler-22-07-29/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-877BXHD6V6"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-877BXHD6V6")}</script><meta property="og:url" content="https://pradeepniroula.com/expositions/riddler-22-07-29/"><meta property="og:site_name" content="Bits & Qubits"><meta property="og:title" content="Riddler: Shell Game and Trapping Electrons"><meta property="og:description" content="Markov Chains and Geometry Optimization"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="expositions"><meta property="article:published_time" content="2022-08-08T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Riddler: Shell Game and Trapping Electrons"><meta name=twitter:description content="Markov Chains and Geometry Optimization"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Technical Notes and Expositions","item":"https://pradeepniroula.com/expositions/"},{"@type":"ListItem","position":2,"name":"Riddler: Shell Game and Trapping Electrons","item":"https://pradeepniroula.com/expositions/riddler-22-07-29/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Riddler: Shell Game and Trapping Electrons","name":"Riddler: Shell Game and Trapping Electrons","description":"Markov Chains and Geometry Optimization","keywords":[],"articleBody":"This post is a response to Zach Wissner-Gross’s Riddler puzzle on the shell game.\nRiddler Express Here is the puzzle description:\nWhile walking down the street one day, you notice people gathering around a woman playing the shell game. With each game, she places a ball under one of three cups, and then swaps the positions of pairs of cups several times before asking passersby which cup they think the ball is now under.\nYou have it on good authority that she is playing fairly, performing all the moves in plain sight, albeit too fast for you to track precisely which cups she’s moving. However, you do have one additional key piece of information — every time she swaps cups, one of them has the ball. In other words, she never swaps the two empty cups.\nWhen it’s your turn to guess, you note which cup she initially places the ball under. Then, as she begins to swap cups, you close your eyes and count the number of swaps. Once she is done, you open your eyes again. What is your best strategy for guessing which cup has the ball?\nThere are three cups, call them A, B and C. After any number of swaps, the probability that the ball is in one of those cups make a distribution. $P_{A,t} + P_{B,t} + P_{C,t}=1$.\nAt time $t$, we know that $P_{A,0}=1$. And, at every $t \u003e 0$, the ball moves from its current position to one of the unoccupied cups.\n$$P_{A,t} = (1/2) P_{B,t-1} + (1/2) P_{C, t-1} \\quad P_{B,t} = (1/2) P_{A,t-1} + (1/2) P_{C, t-1} \\quad P_{C,t} = (1/2) P_{A,t-1} + (1/2) P_{B, t-1} $$\nThis is a Markov Chain problem. The probabilty distribution at time $t$ is given by the following vector\n$$p_t = \\begin{pmatrix} 0 \u0026 1/2 \u0026 1/2 \\newline 1/2 \u0026 0 \u0026 1/2 \\newline 1/2 \u0026 1/2 \u0026 0 \\end{pmatrix}^t \\begin{pmatrix} 1 \\newline 0 \\newline 0\\end{pmatrix}$$\nI used Mathematica to exponentiate the matrix.\nmat = {{0, 1, 1}, {1, 0, 1}, {0, 1, 1}}/2; FullSimplify[MatrixPower[mat, t].Transpose[{{1, 0, 0}}], Assumptions -\u003e {n \u003e 0}] which gives me $$P_{A,t} = \\frac{1}{6}+\\frac{1}{3} \\left(-\\frac{1}{2}\\right)^t \\quad P_{B,t} = \\frac{1}{6}-\\frac{2}{3}\\left(-\\frac{1}{2}\\right)^t \\quad P_{C,t} = \\frac{1}{6} + \\frac{1}{3} \\left(-\\frac{1}{2}\\right)^t$$\nNote, that for $t$ odd, $P_{B,t} \u003e P_{A,t}$ and $P_{B,t} \u003eP_{C,t}$ and for $t$ even $P_{A,t}=P_{C,t} \u003e P_{B,t}$\nTherefore, the solution is to choose B if the number of swaps is odd, othewise A and C with equal probability.\nRiddler Classic Having solved the shell game in this week’s Express, you are now ready to play the quantum shell game. Instead of a ball, you are now trying to capture an electron. Now, you’re not sure precisely where it is, but you know it’s somewhere on a two-dimensional surface. What’s more, you know that the probability distribution is a 2D Gaussian (or “normal”) distribution. More precisely, the probability the electron is a distance r units in any direction from some central point is proportional to $exp(−r^2/2)$.\nYou have four cylindrical cups, each of which has a radius of 1 unit. In this game, you want to place the cups over the surface to maximize the probability that the electron is in one of the cups.\nHow should you place the cups, and what is the probability you will catch the electron?\nExtra credit: What if you have different numbers of cups, like three, five, six or even more? How would you place the cups, and what would be your chances of catching the electron in one of them?\nThe probability mass of the electron is $\\propto e^{-r^2/2}$. Let’s go ahead and normalize it such that it sums to one\n$$ 4\\pi \\int_0^1 dr (k e^{-r^2/2}) = 1\\implies k = \\frac{1}{2\\pi} \\implies p(r) = \\frac{1}{2\\pi} e^{-r^2/2}$$\nLet’s take a computational view of solving this problem. We are solving an optimization problem, with some contraints. The constraints being that the cups are physical objects that can’t overlap.\nConsider a cup located at vector $\\vec{v}$. The probabilty mass function it covers is given by $$\\begin{align*} p_{\\vec{v}} \u0026= \\frac{1}{2}\\int_0^{2\\pi} \\int_0^1 e^{-r^2/2} \\rho : \\mathrm{d}\\rho \\mathrm{d}\\theta \\end{align*}$$\nWe have $r^2 = (\\vec{v} - \\vec{r}_{\\rho, \\theta})^2 = v^2 + r^2 - 2v r \\cos{\\theta}$.\nThis gives us $$p_{\\vec{v}} = \\frac{e^{-v^2/2}}{2\\pi} \\int_0^1 \\mathrm{d}\\rho : e^{-\\rho^2} \\mathrm{d}\\rho \\int_0^{2\\pi} \\mathrm{d}\\theta e^{v\\rho \\cos{\\theta}} \\rho $$\nWe need to find 4 (or in general $n$) points such that the sum of $p_{\\vec{v}_i}$ is maximized while making sure that the circles don’t overlap.\nThe maximization problem can be written as $$ \\begin{align} \\text{maximize } \u0026\\sum_{i=1}^{N} p_{\\vec{v}_i} \\newline \\text{ s.t} \\quad \\quad \u0026|\\vec{v}_i-\\vec{v}_j| \u003e= 2 \\quad \\forall i,j : i \\neq j \\end{align} $$ The constraints ensure that the central locations of the cups are separated enough that their overlap is zero.\nHere is the code that does this optimization.\nimport numpy as np from scipy.integrate import dblquad from scipy.optimize import minimize, NonlinearConstraint def integral_under_cup(x, y): \"\"\" Function to calculate the pmf under the cup situated at v_x, v_y \"\"\" d2 = x**2 + y**2 d = np.sqrt(d2) return np.exp(-d2/2)/(2*np.pi) * dblquad(lambda r, t: np.exp(-(r**2)/2)*r*np.exp(r*d*np.cos(t)), 0, 2*np.pi, 0, 1)[0] def total_pmf_under_cups(x_s): \"\"\" total pmf under all cups x_s: list of x and y coodiantes of N cups. Even positions are x-coordinate. Odd positions are y-coordiante \"\"\" acc = 0 for i in range(len(x_s)//2): acc += integral_under_cup(x_s[2*i], x_s[2*i+1]) return -acc def no_overlap_constraint(x_s): \"\"\" Returns a vector of separation between all pairs of cups. The optimize function should constraint it to be stricly greater than zero. \"\"\" distance = [] for i in range(len(x_s)//2): for j in range(i): x_a, y_a = x_s[2*i], x_s[2*i+1] x_b, y_b = x_s[2*j], x_s[2*j+1] distance.append((x_a - x_b)**2 + (y_a - y_b)**2 - 4) return distance # define the constraint constraints = NonlinearConstraint(no_overlap_constraint, 0, np.inf) # Fix the problem size (number of cups) N=4 # Now optimize! optimal_solution = minimize(total_pmf_under_cups, x0=np.random.uniform(-1, 1, 2*N), constraints=[constraints]) # Here are your final positions optimal_positions = optimal_solution.x I did this for $N \\in [4, 12]$. The results are shown below.\n","wordCount":"991","inLanguage":"en","datePublished":"2022-08-08T00:00:00Z","dateModified":"2022-08-08T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://pradeepniroula.com/expositions/riddler-22-07-29/"},"publisher":{"@type":"Organization","name":"Bits \u0026 Qubits","logo":{"@type":"ImageObject","url":"https://pradeepniroula.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pradeepniroula.com/ accesskey=h title="Bits & Qubits (Alt + H)">Bits & Qubits</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://bleedingedges.substack.com/ title="Bleeding Edges (Newsletter)"><span>Bleeding Edges (Newsletter)</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href="https://scholar.google.com/citations?user=sozxaMYAAAAJ&amp;hl=en" title=Research><span>Research</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://pradeepniroula.com/reviews/ title=Briefs><span>Briefs</span></a></li><li><a href=https://pradeepniroula.com/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://pradeepniroula.com/writings/ title=Writings><span>Writings</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Riddler: Shell Game and Trapping Electrons</h1><div class=post-meta><span title='2022-08-08 00:00:00 +0000 UTC'>August 8, 2022</span></div></header><div class=post-content><p>This post is a response to Zach Wissner-Gross&rsquo;s <a href=https://fivethirtyeight.com/features/can-you-beat-the-shell-game-quantum-style/>Riddler puzzle</a> on the shell game.</p><h2 id=riddler-express>Riddler Express<a hidden class=anchor aria-hidden=true href=#riddler-express>#</a></h2><p>Here is the puzzle description:</p><blockquote><p>While walking down the street one day, you notice people gathering around a woman playing the shell game. With each game, she places a ball under one of three cups, and then swaps the positions of pairs of cups several times before asking passersby which cup they think the ball is now under.</p></blockquote><blockquote><p>You have it on good authority that she is playing fairly, performing all the moves in plain sight, albeit too fast for you to track precisely which cups she’s moving. However, you do have one additional key piece of information — every time she swaps cups, one of them has the ball. In other words, she never swaps the two empty cups.</p></blockquote><blockquote><p>When it’s your turn to guess, you note which cup she initially places the ball under. Then, as she begins to swap cups, you close your eyes and count the number of swaps. Once she is done, you open your eyes again. What is your best strategy for guessing which cup has the ball?</p></blockquote><p>There are three cups, call them A, B and C. After any number of swaps, the probability that the ball is in one of those cups make a distribution. $P_{A,t} + P_{B,t} + P_{C,t}=1$.</p><p>At time $t$, we know that $P_{A,0}=1$. And, at every $t > 0$, the ball moves from its current position to one of the unoccupied cups.</p><p>$$P_{A,t} = (1/2) P_{B,t-1} + (1/2) P_{C, t-1} \quad
P_{B,t} = (1/2) P_{A,t-1} + (1/2) P_{C, t-1} \quad
P_{C,t} = (1/2) P_{A,t-1} + (1/2) P_{B, t-1} $$</p><p>This is a Markov Chain problem. The probabilty distribution at time $t$ is given by the following vector</p><p>$$p_t = \begin{pmatrix} 0 & 1/2 & 1/2 \newline 1/2 & 0 & 1/2 \newline 1/2 & 1/2 & 0 \end{pmatrix}^t \begin{pmatrix} 1 \newline 0 \newline 0\end{pmatrix}$$</p><p>I used Mathematica to exponentiate the matrix.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Mathematica data-lang=Mathematica><span style=display:flex><span>mat <span style=color:#f92672>=</span> {{<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>}, {<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>}, {<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>}}<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>FullSimplify[MatrixPower[mat, t]<span style=color:#960050;background-color:#1e0010>.</span>Transpose[{{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>}}], 
</span></span><span style=display:flex><span> Assumptions <span style=color:#f92672>-&gt;</span> {n <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>}]
</span></span></code></pre></div><p>which gives me
$$P_{A,t} = \frac{1}{6}+\frac{1}{3} \left(-\frac{1}{2}\right)^t \quad P_{B,t} = \frac{1}{6}-\frac{2}{3}\left(-\frac{1}{2}\right)^t \quad P_{C,t} = \frac{1}{6} + \frac{1}{3} \left(-\frac{1}{2}\right)^t$$</p><p>Note, that for $t$ odd, $P_{B,t} > P_{A,t}$ and $P_{B,t} >P_{C,t}$ and for $t$ even $P_{A,t}=P_{C,t} > P_{B,t}$</p><p>Therefore, the solution is to choose B if the number of swaps is odd, othewise A and C with equal probability.</p><h2 id=riddler-classic>Riddler Classic<a hidden class=anchor aria-hidden=true href=#riddler-classic>#</a></h2><blockquote><p>Having solved the shell game in this week’s Express, you are now ready to play the quantum shell game. Instead of a ball, you are now trying to capture an electron. Now, you’re not sure precisely where it is, but you know it’s somewhere on a two-dimensional surface. What’s more, you know that the probability distribution is a 2D Gaussian (or “normal”) distribution. More precisely, the probability the electron is a distance r units in any direction from some central point is proportional to $exp(−r^2/2)$.</p></blockquote><blockquote><p>You have four cylindrical cups, each of which has a radius of 1 unit. In this game, you want to place the cups over the surface to maximize the probability that the electron is in one of the cups.</p></blockquote><blockquote><p>How should you place the cups, and what is the probability you will catch the electron?</p></blockquote><blockquote><p>Extra credit: What if you have different numbers of cups, like three, five, six or even more? How would you place the cups, and what would be your chances of catching the electron in one of them?</p></blockquote><p>The probability mass of the electron is $\propto e^{-r^2/2}$. Let&rsquo;s go ahead and normalize it such that it sums to one</p><p>$$ 4\pi \int_0^1 dr (k e^{-r^2/2}) = 1\implies k = \frac{1}{2\pi} \implies p(r) = \frac{1}{2\pi} e^{-r^2/2}$$</p><p>Let&rsquo;s take a computational view of solving this problem. We are solving an optimization problem, with some contraints. The constraints being that the cups are physical objects that can&rsquo;t overlap.</p><p>Consider a cup located at vector $\vec{v}$. The probabilty mass function it covers is given by
$$\begin{align*} p_{\vec{v}} &= \frac{1}{2}\int_0^{2\pi} \int_0^1 e^{-r^2/2} \rho : \mathrm{d}\rho \mathrm{d}\theta
\end{align*}$$</p><p>We have $r^2 = (\vec{v} - \vec{r}_{\rho, \theta})^2 = v^2 + r^2 - 2v r \cos{\theta}$.</p><p>This gives us
$$p_{\vec{v}} = \frac{e^{-v^2/2}}{2\pi} \int_0^1 \mathrm{d}\rho : e^{-\rho^2} \mathrm{d}\rho \int_0^{2\pi} \mathrm{d}\theta e^{v\rho \cos{\theta}} \rho $$</p><p>We need to find 4 (or in general $n$) points such that the sum of $p_{\vec{v}_i}$ is maximized while making sure that the circles don&rsquo;t overlap.</p><p>The maximization problem can be written as
$$
\begin{align}
\text{maximize } &\sum_{i=1}^{N} p_{\vec{v}_i} \newline
\text{ s.t} \quad \quad &|\vec{v}_i-\vec{v}_j| >= 2 \quad \forall i,j : i \neq j
\end{align}
$$
The constraints ensure that the central locations of the cups are separated enough that their overlap is zero.</p><p>Here is the code that does this optimization.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.integrate <span style=color:#f92672>import</span> dblquad
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.optimize <span style=color:#f92672>import</span> minimize, NonlinearConstraint
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>integral_under_cup</span>(x, y):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Function to calculate the pmf under the cup situated at v_x, v_y
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    d2 <span style=color:#f92672>=</span> x<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> y<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    d <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>sqrt(d2)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>exp(<span style=color:#f92672>-</span>d2<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>/</span>(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>pi) <span style=color:#f92672>*</span> dblquad(<span style=color:#66d9ef>lambda</span> r, t: np<span style=color:#f92672>.</span>exp(<span style=color:#f92672>-</span>(r<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>*</span>r<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>exp(r<span style=color:#f92672>*</span>d<span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>cos(t)), 
</span></span><span style=display:flex><span>                                            <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>np<span style=color:#f92672>.</span>pi, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>total_pmf_under_cups</span>(x_s):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    total pmf under all cups
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    x_s: list of x and y coodiantes of N cups. 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Even positions are x-coordinate.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Odd positions are y-coordiante
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    acc <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(x_s)<span style=color:#f92672>//</span><span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>        acc <span style=color:#f92672>+=</span> integral_under_cup(x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i], x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>acc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>no_overlap_constraint</span>(x_s):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Returns a vector of separation between all pairs of cups.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    The optimize function should constraint it to be stricly greater than zero.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    distance <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(x_s)<span style=color:#f92672>//</span><span style=color:#ae81ff>2</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(i):
</span></span><span style=display:flex><span>            x_a, y_a <span style=color:#f92672>=</span> x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i], x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>            x_b, y_b <span style=color:#f92672>=</span> x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>j], x_s[<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>j<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>            distance<span style=color:#f92672>.</span>append((x_a <span style=color:#f92672>-</span> x_b)<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> (y_a <span style=color:#f92672>-</span> y_b)<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> distance
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># define the constraint</span>
</span></span><span style=display:flex><span>constraints <span style=color:#f92672>=</span> NonlinearConstraint(no_overlap_constraint, <span style=color:#ae81ff>0</span>, np<span style=color:#f92672>.</span>inf)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fix the problem size (number of cups)</span>
</span></span><span style=display:flex><span>N<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Now optimize!</span>
</span></span><span style=display:flex><span>optimal_solution <span style=color:#f92672>=</span> minimize(total_pmf_under_cups, x0<span style=color:#f92672>=</span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>uniform(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>N), constraints<span style=color:#f92672>=</span>[constraints])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Here are your final positions</span>
</span></span><span style=display:flex><span>optimal_positions <span style=color:#f92672>=</span> optimal_solution<span style=color:#f92672>.</span>x
</span></span></code></pre></div><p>I did this for $N \in [4, 12]$. The results are shown below.</p><p><img alt=image loading=lazy src=/expositions/riddler-cups.png></p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://pradeepniroula.com/>Bits & Qubits</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>